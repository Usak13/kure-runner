<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<title>Kuře skáče</title>
<style>
  body {
    margin: 0; 
    font-family: Arial, sans-serif; 
    background: #87ceeb; 
    text-align: center;
    user-select: none;
  }
  #menu {
    padding: 30px;
  }
  button {
    font-size: 20px;
    padding: 12px 25px;
    margin: 10px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    background-color: #4CAF50;
    color: white;
  }
  button:hover {
    background-color: #45a049;
  }
  canvas {
    display: block;
    margin: 20px auto;
    background: #a0d8f7;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  }
</style>
</head>
<body>

<div id="menu">
  <h1>Kuře - Vyber trať</h1>
  <button id="startMountain">1. Hory</button>
  <button id="startCity">2. Město</button>
</div>

<canvas id="gameCanvas" width="700" height="350" style="display:none;"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const menu = document.getElementById('menu');

const GRAVITY = 0.8;
const JUMP_FORCE = -15;

let gameRunning = false;
let obstacles = [];
let score = 0;
let speed = 5;

const player = {
  x: 50,
  y: 250,
  width: 50,
  height: 50,
  vy: 0,
  grounded: false,
  img: new Image()
};
player.img.src = 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Chicken_icon.svg/120px-Chicken_icon.svg.png';

const obstacleImg = new Image();
obstacleImg.src = 'https://cdn.pixabay.com/photo/2012/04/14/16/00/rock-34400_1280.png';

const bgMountain = new Image();
bgMountain.src = 'https://cdn.pixabay.com/photo/2016/04/01/11/58/mountains-1305366_1280.png';

const bgCity = new Image();
bgCity.src = 'https://cdn.pixabay.com/photo/2016/03/27/07/08/city-1284460_1280.png';

let currentBackground = null;

document.getElementById('startMountain').onclick = () => startGame('mountain');
document.getElementById('startCity').onclick = () => startGame('city');

function startGame(track) {
  menu.style.display = 'none';
  canvas.style.display = 'block';
  gameRunning = true;
  score = 0;
  speed = 5;
  obstacles = [];
  player.y = 250;
  player.vy = 0;
  player.grounded = false;

  currentBackground = (track === 'mountain') ? bgMountain : bgCity;

  createObstacles();
  gameLoop();
}

function createObstacles() {
  obstacles = [];
  let posX = 600;
  for(let i = 0; i < 10; i++) {
    let height = 40 + Math.random()*60;
    obstacles.push({ x: posX, y: 300 - height, width: 30, height: height });
    posX += 200;
  }
}

function jump() {
  if (player.grounded) {
    player.vy = JUMP_FORCE;
    player.grounded = false;
  }
}

document.addEventListener('keydown', e => {
  if(e.code === 'Space' && gameRunning) jump();
});
document.addEventListener('click', () => {
  if(gameRunning) jump();
});

function checkCollision(rect1, rect2) {
  return !(rect2.x > rect1.x + rect1.width || 
           rect2.x + rect2.width < rect1.x || 
           rect2.y > rect1.y + rect1.height ||
           rect2.y + rect2.height < rect1.y);
}

function gameLoop() {
  if(!gameRunning) return;

  player.vy += GRAVITY;
  player.y += player.vy;

  if(player.y + player.height >= 300){
    player.y = 300 - player.height;
    player.vy = 0;
    player.grounded = true;
  }

  for(let obs of obstacles){
    obs.x -= speed;
  }

  if(obstacles.length && obstacles[0].x + obstacles[0].width < 0){
    obstacles.shift();
    let lastX = obstacles.length ? obstacles[obstacles.length-1].x : 600;
    let height = 40 + Math.random()*60;
    obstacles.push({ x: lastX + 200, y: 300 - height, width: 30, height: height });
    score++;
    if(score % 5 === 0){
      speed += 0.5;
    }
  }

  for(let obs of obstacles){
    if(checkCollision(player, obs)){
      alert(`Konec hry! Tvoje skóre: ${score}`);
      gameRunning = false;
      menu.style.display = 'block';
      canvas.style.display = 'none';
      return;
    }
  }

  draw();
  requestAnimationFrame(gameLoop);
}

function draw() {
  if(currentBackground && currentBackground.complete){
    ctx.drawImage(currentBackground, 0, 0, canvas.width, canvas.height);
  } else {
    ctx.fillStyle = '#87ceeb';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }

  ctx.fillStyle = '#3B7A57'; 
  ctx.fillRect(0, 300, canvas.width, 50);

  for(let obs of obstacles){
    if(obstacleImg.complete){
      ctx.drawImage(obstacleImg, obs.x, obs.y - 10, obs.width + 20, obs.height + 20);
    } else {
      ctx.fillStyle = '#8B4513';
      ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
    }
  }

  if(player.img.complete){
    ctx.drawImage(player.img, player.x, player.y, player.width, player.height);
  } else {
    ctx.fillStyle = 'yellow';
    ctx.fillRect(player.x, player.y, player.width, player.height);
  }

  ctx.fillStyle = 'black';
  ctx.font = '20px Arial';
  ctx.fillText(`Skóre: ${score}`, 10, 30);
}
</script>

</body>
</html>
